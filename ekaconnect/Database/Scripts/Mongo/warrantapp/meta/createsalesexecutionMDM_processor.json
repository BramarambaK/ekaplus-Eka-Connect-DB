{
  "_id": "createsalesexecutionMDM_processor",
  "name": "createsalesexecutionMDM_processor",
  "type": "processor",
  "refType": "app",
  "refTypeId": "ada131db-5171-4b9c-b6d6-caae0c6cd2f5",
  "snippet": "let selectedData = req.body.selectedData;\r\nvar keys = Object.keys(selectedData);\r\nif (keys.length > 0) {\r\n    var mdmData = [];\r\n    mdmData.push({ key: selectedData.Contract_Ref_No, value: selectedData.Contract_Ref_No });\r\n    var mdmData1 = { sales_contract_ref_no: mdmData };\r\n    res.status(200).send(mdmData1);\r\n} else {\r\n    var contractUrl = req.body.propertyList.eka_connect_host + '/workflow/data';\r\n    var contractBody = {\r\n        appId: req.body.appId,\r\n        workFlowTask: 'dummycontractlist'\r\n    };\r\n    var contract = {\r\n        method: 'POST',\r\n        body: contractBody,\r\n        url: contractUrl,\r\n        headers: {\r\n            Authorization: req.headers.authorization,\r\n            'X-TenantID': req.headers['x-tenantid']\r\n        },\r\n        json: true\r\n    };\r\n    function get_contract() {\r\n        return new Promise(function (resolve, reject) {\r\n            request(contract, function (err, response, body) {\r\n                if (response.statusCode >= 200 && response.statusCode <= 299) {\r\n                    resolve(body);\r\n                }\r\n                else {\r\n                    reject(body);\r\n                }\r\n            });\r\n        });\r\n    }\r\n    get_contract().then(function (result) {\r\n        var contracts = result.data;\r\n        var mdmData = [];\r\n        for (var i = 0; i < contracts.length; i++) {\r\n            var name = contracts[i]['contract_ref_no'].toUpperCase();\r\n            if (name.includes('SC') && contracts[i]['contract_status'] == \"Approved\") {\r\n                mdmData.push({ key: contracts[i]['contract_ref_no'], value: contracts[i]['contract_ref_no'] });\r\n            }\r\n        }\r\n        var mdmData1 = { sales_contract_ref_no: mdmData };\r\n        res.status(200).send(mdmData1);\r\n    });\r\n}\r\n",
  "sys__UUID": "000a7abf-2ad6-47a7-ad48-93dea8979ef8",
  "sys__createdBy": "ekauser@ekaplus.com"
}
