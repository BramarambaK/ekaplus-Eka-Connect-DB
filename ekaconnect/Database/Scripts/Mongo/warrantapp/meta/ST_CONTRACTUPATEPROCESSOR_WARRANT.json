{
  "_id": "ST_CONTRACTUPATEPROCESSOR_WARRANT",
  "name": "ST_CONTRACTUPATEPROCESSOR_WARRANT",
  "type": "processor",
  "refType": "app",
  "refTypeId": "ada131db-5171-4b9c-b6d6-caae0c6cd2f5",
  "snippet": "\r\nvar connectGetUrl =\r\n    req.body.propertyList.eka_connect_host +\r\n    '/data/ada131db-5171-4b9c-b6d6-caae0c6cd2f5/5c2d334d-50aa-4194-a7e6-c9055b744c2e';\r\nvar connectDeleteUrl =\r\n    req.body.propertyList.eka_connect_host +\r\n    '/data/ada131db-5171-4b9c-b6d6-caae0c6cd2f5/5c2d334d-50aa-4194-a7e6-c9055b744c2e/bulkDelete';\r\nvar connectGet = {\r\n    method: 'GET',\r\n    url: connectGetUrl,\r\n    headers: {\r\n        Authorization: req.headers.authorization,\r\n        'X-TenantID': req.headers['x-tenantid']\r\n    },\r\n    json: true\r\n};\r\nvar connectDelete = {\r\n    method: 'DELETE',\r\n    url: connectDeleteUrl,\r\n    headers: {\r\n        Authorization: req.headers.authorization,\r\n        'X-TenantID': req.headers['x-tenantid']\r\n    },\r\n    json: true\r\n};\r\nfunction get_connect_delete(body) {\r\n    connectDelete.body = {};\r\n    connectDelete.body = body;\r\n    return new Promise(function (resolve, reject) {\r\n        request(connectDelete, function (err, response, body) {\r\n            if (response.statusCode >= 200 && response.statusCode <= 299) {\r\n                resolve(body);\r\n            }\r\n            else {\r\n                reject(body);\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction get_connect_get(body) {\r\n    connectGet.body = {};\r\n    connectGet.body = body;\r\n    return new Promise(function (resolve, reject) {\r\n        request(connectGet, function (err, response, body) {\r\n            if (response.statusCode >= 200 && response.statusCode <= 299) {\r\n                resolve(body);\r\n            }\r\n            else {\r\n                reject(body);\r\n            }\r\n        });\r\n    });\r\n}\r\nvar bulkPayLoadData = req.body.bulkPayLoadData;\r\n\r\nvar value = [];\r\nbulkPayLoadData.forEach(element => {\r\n    value.push(element.contract_ref_no);\r\n});\r\nvar getFilter = {\r\n    filterData: {\r\n        filter: [\r\n            {\r\n                fieldName: 'contract_ref_no',\r\n                value: value,\r\n                operator: 'in'\r\n            }\r\n        ]\r\n    }\r\n};\r\nget_connect_get(getFilter).then(function (result) {\r\n    var sys__UUID_array = [];\r\n    for (var i = 0; i < bulkPayLoadData.length; i++) {\r\n        for (var j = 0; j < result.length; j++) {\r\n            if (\r\n                bulkPayLoadData[i]['contract_ref_no'] == result[j]['contract_ref_no'] &&\r\n                !result[j]['CP_Name'] &&\r\n                !result[j]['Strategy'] &&\r\n                !result[j]['CP_Name']\r\n            ) {\r\n                sys__UUID_array.push(result[j]['sys__UUID']);\r\n            }\r\n        }\r\n    }\r\n    var filter_delete = {\r\n        filterData: {\r\n            filter: [\r\n                {\r\n                    fieldName: 'sys__UUID',\r\n                    value: sys__UUID_array,\r\n                    operator: 'in'\r\n                }\r\n            ]\r\n        }\r\n    };\r\n    get_connect_delete(filter_delete).then(function (result1) {\r\n        var outputData = [];\r\n        bulkPayLoadData.forEach(element => {\r\n            outputData.push({ contract_ref_no: element.contract_ref_no, contract_status: element.contract_status });\r\n        });\r\n        res.status(200).send(outputData);\r\n    });\r\n});\r\n",
  "sys__UUID": "b26d8c74-e75e-4bba-825f-6f0e70c3858e",
  "sys__createdBy": "ekauser@ekaplus.com"
}
