{
  "_id": "_ST_CREATE_PROCESSOR_STOCKLIST_PROCESSOR_WARRANT",
  "name": "_ST_CREATE_PROCESSOR_STOCKLIST_PROCESSOR",
  "type": "processor",
  "refType": "app",
  "refTypeId": "ada131db-5171-4b9c-b6d6-caae0c6cd2f5",
  "snippet": "\r\nvar moment = require('moment');\r\nvar bulkPayLoadData = req.body.bulkPayLoadData;\r\nvar body = [];\r\nvar url = req.body.propertyList.platform_url + '/api/logistic/stockDetailsUpdate';\r\nvar apiDetails = {\r\n    method: 'PUT',\r\n    url: url,\r\n    headers: {\r\n        Authorization: req.headers.authorization,\r\n        'Content-Type': 'application/json'\r\n    },\r\n    json: true\r\n};\r\nfunction post_data(body) {\r\n    apiDetails.body = [];\r\n    apiDetails.body = body;\r\n    console.log(apiDetails.body);\r\n    return new Promise(function (resolve, reject) {\r\n        request(apiDetails, function (err, response, body) {\r\n            console.log(body);\r\n            if (response.statusCode >= 200 && response.statusCode <= 299) {\r\n                resolve(body);\r\n            }\r\n            else {\r\n                reject(body);\r\n            }\r\n        });\r\n    });\r\n}\r\nfor (var i = 0; i < bulkPayLoadData.length; i++) {\r\n    if (bulkPayLoadData[i]['grading_status'] == 'NA') bulkPayLoadData[i]['grading_status'] = 'Pending';\r\n    var final_weight_date = moment\r\n        .utc(bulkPayLoadData[i]['final_weight_date'])\r\n        .utcOffset('+0530')\r\n        .format('YYYY-MM-DD');\r\n    var Grading_Date = moment\r\n        .utc(bulkPayLoadData[i]['Grading_Date'])\r\n        .utcOffset('+0530')\r\n        .format('YYYY-MM-DD');\r\n    var exchange_type = '';\r\n    var productClass = '';\r\n    if (bulkPayLoadData[i]['exchange_type']) {\r\n        exchange_type = bulkPayLoadData[i]['exchange_type'];\r\n    }\r\n    if (bulkPayLoadData[i]['class']) {\r\n        productClass = bulkPayLoadData[i]['class'];\r\n    }\r\n    body.push({\r\n        certificationStatus: bulkPayLoadData[i]['certification_status'],\r\n        gradingStatus: bulkPayLoadData[i]['grading_status'],\r\n        externalStkRefNo: bulkPayLoadData[i]['ext_stock_ref_no'],\r\n        gradingDate: Grading_Date,\r\n        finalWeightDate: final_weight_date,\r\n        exchangeType: exchange_type,\r\n        productClass: productClass,\r\n        isDeleted: 'N',\r\n        goodsRecordDetailPkDO: {\r\n            internalGrdRefNo: bulkPayLoadData[i]['internal_grd_dgrd_ref_no']\r\n        }\r\n    });\r\n}\r\npost_data(body)\r\n    .then(function (result) {\r\n        res.status(200).send(result);\r\n    })\r\n    .catch(err => {\r\n        res.status(500).send('Post to TRM Api not working');\r\n    });\r\n",
  "sys__UUID": "c4620cab-ee84-4cf9-ad1b-b013c05b0d44",
  "sys__createdBy": "ekauser@ekaplus.com"
}
