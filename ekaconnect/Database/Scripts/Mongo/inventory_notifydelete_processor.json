{
  "_id": "inventory_notifydelete_processor",
  "name": "inventory_notifydelete_processor",
  "type": "processor",
  "refType": "app",
  "refTypeId": "12325a98-a959-4939-9005-4158d136afcd",
  "snippet": "\r\n    var connectData = {\r\n      method: \"GET\",\r\n      url:\r\n        req.body.propertyList.eka_connect_host +\r\n        \"/data/12325a98-a959-4939-9005-4158d136afcd/f895de3c-5f05-4671-b70d-4c180078fc07?bpRefNo=\",\r\n      headers: {\r\n        Authorization: req.headers.authorization,\r\n        \"X-TenantID\": req.headers[\"x-tenantid\"],\r\n      },\r\n      json: true,\r\n    };\r\n    function get_connectData() {\r\n      return new Promise(function (resolve, reject) {\r\n        request(connectData, function (err, response, body) {\r\n          if (response.statusCode >= 200 && response.statusCode <= 299) {\r\n            resolve(body);\r\n          }\r\n          else {\r\n            reject(body);\r\n          }\r\n        });\r\n      });\r\n    }\r\n\r\n    let finalData = [];\r\n    let data = req.body.bulkPayLoadData;\r\n    console.log(data);\r\n    if (data) {\r\n      connectData.url =\r\n        req.body.propertyList.eka_connect_host +\r\n        \"/data/12325a98-a959-4939-9005-4158d136afcd/f895de3c-5f05-4671-b70d-4c180078fc07?bpRefNo=\" +\r\n        data[0].bpRefNo +\r\n        \"&quality=\" +\r\n        data[0].quality +\r\n        \"&cropYear=\" +\r\n        data[0].cropYear +\r\n        \"&site=\" +\r\n        data[0].site;\r\n      get_connectData()\r\n        .then(async (result) => {\r\n          data[0].sys__data__state = \"Delete\";\r\n          if (result.length > 0) {\r\n            data[0][\"id\"] = result[0][\"_id\"];\r\n            finalData.push(data[0]);\r\n            for (let i = 1; i < data.length; i++) {\r\n              connectData.url =\r\n                req.body.propertyList.eka_connect_host +\r\n                \"/data/12325a98-a959-4939-9005-4158d136afcd/f895de3c-5f05-4671-b70d-4c180078fc07?bpRefNo=\" +\r\n                data[i].bpRefNo +\r\n                \"&quality=\" +\r\n                data[0].cropYear +\r\n                \"&cropYear=\" +\r\n                data[0].quality +\r\n                \"&site=\" +\r\n                data[0].site;\r\n              await get_connectData()\r\n                .then((record) => {\r\n                  data[i].sys__data__state = \"Delete\";\r\n                  data[i][\"id\"] = record[0][\"_id\"];\r\n                  finalData.push(data[i]);\r\n                })\r\n                .catch((err) => {\r\n                  res.status(500).send(err);\r\n                });\r\n            }\r\n            res.status(200).send(finalData);\r\n          }\r\n          else {\r\n            res.status(500).send(\"No Records Found\");\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          res.status(500).send(err);\r\n        });\r\n    }\r\n  ",
  "sys__UUID": "e65af340-1649-499d-8a1b-c697d3c20f3c"
}
