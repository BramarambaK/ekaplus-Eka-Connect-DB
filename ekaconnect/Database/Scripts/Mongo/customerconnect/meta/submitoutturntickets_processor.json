{
    "_id" : "submitoutturntickets_processor",
    "name" : "submitoutturntickets_processor",
    "type" : "processor",
    "refType" : "app",
    "refTypeId" : "12325a98-a959-4939-9005-4158d136afcd",
    "snippet" : "\r\n    const data = req.body.selectedData.data;\r\n    console.log('Rendered Cards:', JSON.stringify(data[0]));\r\n    const send = (status, message) => res.status(status).send(message);\r\n\r\n    if (data && data.length > 0) {\r\n      const cardsList = [];\r\n      const reducedData = data.reduce(\r\n        (acc, curr) => {\r\n          if (!acc.grades.includes(curr.quality)) {\r\n            acc.grades.push(curr.quality);\r\n          }\r\n\r\n          acc.outturnQty += parseFloat(curr.outturnQty);\r\n          return acc;\r\n        },\r\n        {\r\n          grades: [],\r\n          totalQuantity: 0\r\n        }\r\n      );\r\n\r\n      cardsList.push({\r\n        cardType: 'count',\r\n        count: data.filter(i => i.outturnTransferQty > 0).length,\r\n        bpName: `${data[0].bpName} - ${data[0].bpRefNo}`,\r\n        acquirer: data[0].acquirer\r\n      });\r\n\r\n      cardsList.push({\r\n        cardType: 'site',\r\n        site: data[0].location\r\n      });\r\n\r\n      cardsList.push({\r\n        cardType: 'commodity',\r\n        commodity: data[0].product\r\n      });\r\n\r\n      cardsList.push({\r\n        cardType: 'grade',\r\n        grades: (reducedData.grades.length > 3 ? reducedData.grades.slice(0, 3) : reducedData.grades).join(', '),\r\n        suffix: reducedData.grades.length > 3 ? `+${reducedData.grades.length - 3} more` : null,\r\n        suffixTooltip: reducedData.grades.length > 3 ? reducedData.grades.slice(3).join(', ') : null\r\n      });\r\n\r\n      cardsList.push({\r\n        cardType: 'OutturnQty',\r\n        OutturnQty: data[0].outturnQty + ' MT'\r\n      });\r\n      cardsList.push({\r\n        cardType: 'formattedEstimatedPrice',\r\n        formattedEstimatedPrice: data[0].formattedEstimatedOutturnFee\r\n       });\r\n\r\n\r\n      send(200, {\r\n        submitoutTurncardview : cardsList,\r\n        data\r\n      });\r\n    } else {\r\n      send(400, 'No data to be added');\r\n    }\r\n  ",
    "sys__UUID" : "4ff20b54-cdd2-43e0-b122-d97fafd33cb8"
}