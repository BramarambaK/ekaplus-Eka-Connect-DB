{
  "_id": "amendticket_details_processor",
  "name": "amendticket_details_processor",
  "type": "processor",
  "refType": "app",
  "refTypeId": "12325a98-a959-4939-9005-4158d136afcd",
  "snippet": "const send = (status, message) => res.status(status).send(message);\r\n    const sendError = (message, index) =>\r\n      res.status(400).send({\r\n        errorCode: '004',\r\n        errorMessage: message,\r\n        errorContext: null,\r\n        errorLocalizedMessage: message,\r\n        errors: [\r\n          {\r\n            errorCode: '004',\r\n            errorMessage: message,\r\n            errorContext: '{formarray:amendticketlist}',\r\n            errorLocalizedMessage: message,\r\n            errors: [{\r\n              errorCode: '004',\r\n              errorMessage: message,\r\n              errorContext: `{formarray:${index}}`,\r\n              errorLocalizedMessage: message,\r\n              errors: null,\r\n            }],\r\n          },\r\n        ],\r\n      });\r\n\r\n    let data;\r\n    let originalData;\r\n    if(req.body.processorDetails && req.body.amendticketwarehoused){\r\n      data =  req.body.amendticketwarehoused && req.body.amendticketwarehoused.amendticket_warehoused_details && req.body.amendticketwarehoused.amendticket_warehoused_details.amendticketlist;\r\n      originalData =  req.body.ticketlistingcomposite; \r\n\r\n      if (data && originalData && data.length > 0) {\r\n        for (let i = 0; i < data.length; i++) {\r\n          if (!data[i].amendedPaddockLocation) {\r\n            return sendError(\"Please select the Paddock location\", 6);\r\n          } else if (!data[i].amendedTruckRegistration) {\r\n            return sendError(\"Please enter the truck registration\", 7);\r\n          }\r\n          else if (!data[i].varietyNameList) {\r\n            return sendError(\"Please select the variety\", 8);\r\n          }\r\n\r\n          data[i].origPaddockLocation = originalData[i].paddockLocation;\r\n          data[i].origTruckRegistration = originalData[i].truckRegistration;\r\n          data[i] = {...originalData[i], ...data[i]}\r\n        }\r\n        res.status(200).send(data);\r\n      } else {\r\n        send(400, 'No data to available');\r\n      }\r\n\r\n    }else if(req.body.processorDetails && req.body.amendticketsold){\r\n      data = req.body.processorDetails && req.body.amendticketsold && req.body.amendticketsold.amendticket_sold_details && req.body.amendticketsold.amendticket_sold_details.amendticketlist;\r\n      originalData =  req.body.ticketlistingcomposite;\r\n      if (data && data.length > 0) {\r\n        for (let i = 0; i < data.length; i++) {\r\n          if (!data[i].varietyNameList) {\r\n            return sendError(\"Please select the variety\", 2);\r\n          }else if (!data[i].amendedPaddockLocation) {\r\n            return sendError(\"Please select the Paddock location\", 7);\r\n          } else if (!data[i].amendedTruckRegistration) {\r\n            return sendError(\"Please enter the truck registration\", 8);\r\n          }else if (!data[i].amendedContractId) {\r\n            return sendError(\"Please enter the Contract number\", 11);\r\n          }\r\n\r\n          data[i].origPaddockLocation = originalData[i].paddockLocation;\r\n          data[i].origTruckRegistration = originalData[i].truckRegistration;\r\n          data[i].origContractId = originalData[i].contractId;\r\n          data[i] = {...originalData[i], ...data[i]}\r\n        }\r\n        res.status(200).send(data);\r\n      } else {\r\n        send(400, 'No data to available');\r\n      }\r\n    }else{\r\n      send(400, 'No data to available');\r\n    }",
  "sys__UUID": "b4650517-71d4-4b08-8afc-c1d9f31e790f"
}
