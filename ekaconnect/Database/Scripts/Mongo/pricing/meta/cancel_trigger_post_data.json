{
    "_id" : "cancel_trigger_post_data",
    "name" : "cancel_trigger_post_data",
    "type" : "processor",
    "refType" : "app",
    "refTypeId" : "84d7b167-1d9f-406d-b974-bea406a25f9a",
    "snippet" : "const { internalContractItemRefNo, gmrRefNo, fixationRefNo } =\r\n  req.body;\r\nfunction get_defaultData(body) {\r\n  return new Promise(function (resolve, reject) {\r\n    request(body, function (err, response, body) {\r\n      if (response.statusCode >= 200 && response.statusCode <= 299) {\r\n        resolve(body); \/\/Success\r\n      } else {\r\n        reject(body); \/\/Failure\r\n      }\r\n    });\r\n  });\r\n}\r\nasync function cog_update() {\r\n  var defaultdata1 = {\r\n    method: \"POST\",\r\n    url:\r\n      req.body.propertyList.platform_url +\r\n      \"\/api\/gmr\/postcog?internalGMRRefNo=\" +\r\n      gmrRefNo +\r\n      \"&itemRefNo=\" +\r\n      internalContractItemRefNo,\r\n    body: {},\r\n    headers: {\r\n      Authorization: req.headers.authorization,\r\n      \"X-TenantID\": req.headers[\"x-tenantid\"],\r\n    },\r\n    json: true,\r\n  };\r\n  return await get_defaultData(defaultdata1);\r\n}\r\nvar pricingurl = {\r\n  method: \"POST\",\r\n  url: req.body.propertyList.eka_pricing_host + \"\/api\/pricing\/fixation\/cancel\",\r\n  body: {\r\n    internalContractItemRefNo: internalContractItemRefNo,\r\n    fixationRefNo: fixationRefNo,\r\n  },\r\n  headers: {\r\n    Authorization: req.headers.authorization,\r\n    \"X-TenantID\": req.headers[\"x-tenantid\"],\r\n  },\r\n  json: true,\r\n};\r\nasync function pricing_call() {\r\n  return new Promise(function (resolve, reject) {\r\n    request(pricingurl, function (error, response, body) {\r\n      if (response.statusCode >= 200 && response.statusCode <= 299) {\r\n        resolve(body); \/\/Success\r\n      } else {\r\n        reject(body); \/\/Failure\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nasync function main() {\r\n  let message = {\r\n    status: \"\",\r\n    data: \"\",\r\n  };\r\n  try {\r\n    let pricing = await pricing_call();\r\n    let c = await cog_update();\r\n  } catch (err) {\r\n    console.log(err);\r\n  }\r\n  message.status = \"200\";\r\n  message.data = \"Cancelled\";\r\n  return message;\r\n}\r\nmain().then((message) => {\r\n  if (message.status == \"200\") res.status(200).send(message);\r\n  else res.status(200).send({});\r\n});\r\n",
    "sys__UUID" : "ae12c79a-9146-4b29-aba2-cf098fd99db5",
    "sys__createdBy" : "avinash@ekaplus.com"
}