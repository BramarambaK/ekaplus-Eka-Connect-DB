{
  "_id": "getconfig_processor",
  "name": "getconfig",
  "type": "processor",
  "refType": "app",
  "refTypeId": "admin",
  "snippet": "\r\n    let app_uuid = req.body.selectedData.app_uuid;\r\n    var config = {\r\n      method: \"GET\",\r\n      url: req.body.propertyList.eka_connect_host + \"/meta/workflow\",\r\n      headers: {\r\n        Authorization: req.headers.authorization,\r\n        \"X-TenantID\": req.headers[\"x-tenantid\"],\r\n      },\r\n      json: true,\r\n      body: {},\r\n    };\r\n    function get_config() {\r\n      return new Promise(function (resolve, reject) {\r\n        request(config, function (err, response, body) {\r\n          if (err || body.error) reject(body);\r\n          else resolve(body);\r\n        });\r\n      });\r\n    }\r\n\r\n    var execution = {\r\n      method: \"POST\",\r\n      url: req.body.propertyList.eka_connect_host + \"/workflow/data\",\r\n      headers: {\r\n        Authorization: req.headers.authorization,\r\n        \"X-TenantID\": req.headers[\"x-tenantid\"],\r\n      },\r\n      json: true,\r\n      body: { appId: app_uuid, qP: { from: 0, size: 200 } },\r\n    };\r\n    function save_execution() {\r\n      return new Promise(function (resolve, reject) {\r\n        request(execution, function (err, response, body) {\r\n          if (err || body.error) reject(body);\r\n          else resolve(body);\r\n        });\r\n      });\r\n    }\r\n    if (req.body.selectedData.operation == \"loadData\") {\r\n      config.body = {\r\n        filterData: {\r\n          filter: [\r\n            {\r\n              fieldName: \"tag\",\r\n              value: \"config\",\r\n              operator: \"eq\",\r\n            },\r\n            {\r\n              fieldName: \"refTypeId\",\r\n              value: app_uuid,\r\n              operator: \"eq\",\r\n            },\r\n          ],\r\n        },\r\n      };\r\n      get_config()\r\n        .then((result) => {\r\n          if (Array.isArray(result)) res.status(200).send(result);\r\n          else {\r\n            var data = [];\r\n            data.push(result);\r\n            res.status(200).send(data);\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          res.status(500).send(err);\r\n        });\r\n    } else if (req.body.selectedData.operation == \"executeConfig\") {\r\n      if (\r\n        req.body.selectedData.executePayload &&\r\n        req.body.selectedData.executePayload.taskId\r\n      )\r\n        execution.body.workFlowTask = req.body.selectedData.executePayload.taskId;\r\n      save_execution()\r\n        .then((result) => {\r\n          res.status(200).send(result);\r\n        })\r\n        .catch((err) => {\r\n          res.status(500).send(err.message);\r\n        });\r\n    }\r\n\r\n  ",
  "sys__UUID": "65ff2f3a-deba-456e-8c10-6140b22d72e4"
}
