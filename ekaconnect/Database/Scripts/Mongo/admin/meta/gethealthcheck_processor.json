{
  "_id": "gethealthcheck_processor",
  "name": "gethealthcheck",
  "type": "processor",
  "refType": "app",
  "refTypeId": "admin",
  "snippet": "let appId = req.body.selectedData.appId;\r\nvar connect = {\r\n  method: \"GET\",\r\n  url:\r\n    req.body.propertyList.eka_connect_host +\r\n    \"\/data\/\" +\r\n    appId +\r\n    \"\/7f2b3103-3b67-4dd6-aed7-9d99652b7586\",\r\n  headers: {\r\n    Authorization: req.headers.authorization,\r\n    \"X-TenantID\": req.headers[\"x-tenantid\"],\r\n  },\r\n  json: true,\r\n};\r\nfunction get_connect() {\r\n  return new Promise(function (resolve, reject) {\r\n    request(connect, function (err, response, body) {\r\n      if (err || body.error) reject(body);\r\n      else resolve(body);\r\n    });\r\n  });\r\n}\r\nvar runScheduler = {\r\n  method: \"POST\",\r\n  url: req.body.propertyList.eka_connect_host + \"\/scheduler\/healthcheck\",\r\n  headers: {\r\n    Authorization: req.headers.authorization,\r\n    \"X-TenantID\": req.headers[\"x-tenantid\"],\r\n  },\r\n  json: true,\r\n  body: {\r\n    appId: appId,\r\n  },\r\n};\r\nfunction run_Scheduler() {\r\n  return new Promise(function (resolve, reject) {\r\n    request(runScheduler, function (err, response, body) {\r\n      if (err || body.error) reject(body);\r\n      else resolve(body);\r\n    });\r\n  });\r\n}\r\nif (req.body.selectedData.operation == \"loadData\") {\r\n  get_connect()\r\n    .then((result) => {\r\n      var data = result;\r\n      connect.url =\r\n        req.body.propertyList.eka_connect_host +\r\n        \"\/data\/admin\/7f2b3103-3b67-4dd6-aed7-9d99652b7586\";\r\n      get_connect().then((result) => {\r\n        var final = data.concat(result);\r\n        res.status(200).send(final);\r\n      });\r\n    })\r\n    .catch((err) => {\r\n      res.status(500).send(err);\r\n    });\r\n} else if (req.body.selectedData.operation == \"runScheduler\") {\r\n  run_Scheduler()\r\n    .then((data) => {\r\n      if (data.data[0].status == \"success\") {\r\n        get_connect()\r\n          .then((result) => {\r\n            var data = result;\r\n            connect.url =\r\n              req.body.propertyList.eka_connect_host +\r\n              \"\/data\/admin\/7f2b3103-3b67-4dd6-aed7-9d99652b7586\";\r\n            get_connect().then((result) => {\r\n              var final = data.concat(result);\r\n              res.status(200).send(final);\r\n            });\r\n          })\r\n          .catch((err) => {\r\n            res.status(500).send(err);\r\n          });\r\n      }\r\n    })\r\n    .catch(function (err) {\r\n      res.status(500).send(err);\r\n    });\r\n}\r\n",
  "sys__UUID": "f3f8dcb0-e21a-425c-8f66-c111d0609cd9",
  "sys__createdOn": ISODate("2019-06-26T08:50:01.556Z"),
  "sys__createdBy": "Bravo"
}
