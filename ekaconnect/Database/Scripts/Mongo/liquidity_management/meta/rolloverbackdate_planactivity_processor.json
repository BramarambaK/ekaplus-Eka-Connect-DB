{
    "_id" : "Initial_Processor_for_rollbackdate_LP",
    "name" : "Initial_Processor_for_rollbackdate_LP",
    "type" : "processor",
    "refType" : "app",
    "refTypeId" : "d88e9a79-c0cc-4c28-bb01-ee56ff33048e",
    "snippet" : "const moment = require('moment');\r\nfunction getBackDate(res){\r\n    if(res.liquidityPlanPeriod && res.planEndDate && res.planEndDateHidden && res.planStartDate && res.planStartDateHidden){\r\n        if(res.liquidityPlanPeriod == 'Daily') {\r\n         let previousStartDate = moment(res.planStartDate).subtract(14, \"days\").format('YYYY-MM-DD');\r\n         let previousEndDate = moment(res.planEndDate).subtract(14, \"days\").format('YYYY-MM-DD');\r\n          if(previousStartDate >= res.planStartDateHidden && previousStartDate <= res.planEndDateHidden && previousEndDate >= res.planStartDateHidden && previousEndDate <= res.planEndDateHidden){\r\n            res.planStartDate = previousStartDate;\r\n            res.planEndDate = previousEndDate;\r\n          }\r\n\r\n        }\r\n        if(res.liquidityPlanPeriod == 'Monthly') {\r\n            let previousStartDate = moment(res.planStartDate).subtract(11, \"months\").subtract(1,'days').format('YYYY-MM-DD');\r\n            let previousEndDate = moment(res.planEndDate).subtract(11, \"months\").subtract(1,'days').format('YYYY-MM-DD');\r\n            if(previousStartDate >= res.planStartDateHidden && previousStartDate <= res.planEndDateHidden && previousEndDate >= res.planStartDateHidden && previousEndDate <= res.planEndDateHidden){\r\n                res.planStartDate = previousStartDate;\r\n                res.planEndDate = previousEndDate;\r\n              }\r\n   \r\n           }\r\n           if(res.liquidityPlanPeriod == 'Weekly') {\r\n            let previousStartDate = moment(res.planStartDate).subtract(12, \"weeks\").subtract(1,'days').format('YYYY-MM-DD');\r\n            let previousEndDate = moment(res.planEndDate).subtract(12, \"weeks\").subtract(1,'days').format('YYYY-MM-DD');\r\n            if(previousStartDate >= res.planStartDateHidden && previousStartDate <= res.planEndDateHidden && previousEndDate >= res.planStartDateHidden && previousEndDate <= res.planEndDateHidden){\r\n                res.planStartDate = previousStartDate;\r\n                res.planEndDate = previousEndDate;\r\n              }\r\n   \r\n           }\r\n    }\r\n    return res;\r\n}\r\nlet response = req.body.activityData;\r\nlet formattedResponse = getBackDate(response);\r\nres.status(200).send({...formattedResponse})",
    "sys__UUID" : "9b9c4d45-af20-4ed8-a94c-112da9aecc0f"
}