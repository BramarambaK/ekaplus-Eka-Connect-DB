{
    "_id" : "updateapp_processor",
    "name" : "updateapp",
    "type" : "processor",
    "refType" : "app",
    "refTypeId" : "admin",
    "snippet" : "\r\n    var prepackagedflag = false;\r\n    for (var p = 0; p < req.body.propertyList.seeded_apps.length; p++) {\r\n      if (req.body.propertyList.seeded_apps[p] == req.body.selectedData.data.platformId) {\r\n        prepackagedflag = true;\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (prepackagedflag) {\r\n      var appupdateURL =\r\n        req.body.propertyList.eka_connect_host + '\/meta\/customizedDocument\/' + req.body.selectedData.app_uuid;\r\n      var appupdatebody = req.body.selectedData.data;\r\n\r\n      appupdatebody.refTypeId = req.body.selectedData.data.sys__UUID;\r\n      appupdatebody.app_UUID = req.body.selectedData.data.sys__UUID;\r\n      appupdatebody.customizeLevel = 'system';\r\n      appupdatebody.type = 'customizedDocument';\r\n      appupdatebody.refType = 'app';\r\n      delete appupdatebody.sys__UUID;\r\n      delete appupdatebody.platformId;\r\n      var appupdate = {\r\n        method: 'PUT',\r\n        url: appupdateURL,\r\n        headers: {\r\n          'Content-Type': 'application\/json',\r\n          Authorization: req.headers.authorization,\r\n          'X-TenantID': req.headers['x-tenantid']\r\n        },\r\n        body: appupdatebody,\r\n        json: true\r\n      };\r\n      function update_app() {\r\n        return new Promise(function(resolve, reject) {\r\n          request(appupdate, function(err, response, body) {\r\n            if (err || body.error) reject(body);\r\n            else {\r\n              resolve(body);\r\n            }\r\n          });\r\n        });\r\n      }\r\n      update_app()\r\n        .then(result => {\r\n          res.status(200).send(result);\r\n        })\r\n        .catch(err => {\r\n          console.log('Error Executing Processor -' + err);\r\n          res.status(500).send(err);\r\n        });\r\n    } else {\r\n      var appupdateURL = req.body.propertyList.eka_connect_host + '\/meta\/app\/' + req.body.selectedData.app_uuid;\r\n      delete req.body.selectedData.data.platformId;\r\n      var appupdatebody = req.body.selectedData.data;\r\n      var appupdate = {\r\n        method: 'PUT',\r\n        url: appupdateURL,\r\n        headers: {\r\n          'Content-Type': 'application\/json',\r\n          Authorization: req.headers.authorization,\r\n          'X-TenantID': req.headers['x-tenantid']\r\n        },\r\n        body: appupdatebody,\r\n        json: true\r\n      };\r\n      function update_app() {\r\n        return new Promise(function(resolve, reject) {\r\n          request(appupdate, function(err, response, body) {\r\n            if (err || body.error) reject(body);\r\n            else {\r\n              resolve(body);\r\n            }\r\n          });\r\n        });\r\n      }\r\n      update_app()\r\n        .then(result => {\r\n          res.status(200).send(result);\r\n        })\r\n        .catch(err => {\r\n          console.log('Error Executing Processor -' + err);\r\n          res.status(500).send(err);\r\n        });\r\n    }\r\n  ",
    "sys__UUID" : "056f28d8-c650-48cb-bb46-4ea692469b1e",
    "sys__createdOn" : ISODate("2019-06-26T08:50:01.556Z"),
    "sys__createdBy" : "Bravo"
}